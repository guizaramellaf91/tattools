<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
<link type="text/css" rel="stylesheet" href="css/materialize.min.css" media="screen,projection" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta charset="ISO-8859-1">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<title>Tattools - Usu&aacute;rios</title>
</head>
<div th:replace="fragments/header :: header">&nbsp;</div>
<body th:background="@{/img/backgroundall.png}">
<div class="container" align="center">
<br><br>
<a href="cadastrarUsuario" style="font-size: 12px;" class="waves-effect waves-light grey darken-1 lighten-1 btn-small"><i class="material-icons left">person_add</i>Cadastrar Usu&aacute;rio</a>
<br><br>
<label style="font-weight: bold;" th:text="'N&deg; Usu&aacute;rios: ' + ${quantidadeUsuarios} + ' / Ativos: ' + ${quantidadeUsuariosAtivos} + ' / Inativos: ' + ${quantidadeUsuariosInativos}"></label>
</div>
<br>
<form id="formBuscarUsuario" action="buscarUsuario" class="container" method="post">
<input type="text" style="font-size: 12px; font-weight: bold; color: #737373;" id="nomeUsuario" name="nomeUsuario" placeholder="Digite o nome do usu&aacute;rio"/>
<a onclick="buscarUsuarioAgora()" style="font-size: 12px;" class="waves-effect waves-light grey darken-1 lighten-1 btn"><i class="material-icons left">search</i>Buscar</a>
<a th:href=@{/usuarios} style="font-size: 12px;" class="waves-effect waves-light grey darken-1 lighten-1 btn"><i class="material-icons left">refresh</i>Limpar</a>
</form>
<br>
<div align="center"><strong><label style="color: #b30000;" id="msg" th:text="${msg}"></label></strong></div>
<br><br>
<table class="container">
<thead>
<tr style="font-size: 12px;">
<th>Nome</th>
<th>Tipo</th>
<th>&Uacute;ltimo Acesso</th>
<th>Acessos</th>
<th>Status</th>
<th>Perfil</th>
</tr>
</thead>
<tbody style="font-size: 12px;">
<tr th:each="usuario : ${usuarios}" th:style="${{usuario.login eq usuarioLogado.login} ? 'font-size: 13px; font-weight: bold;' : 'font-size: 12px;'}">
<td><span th:text="${usuario.nome}"></span></td>
<td><span th:text="${usuario.tipoUsuario.nomeTipo}"></span></td>
<td><span th:text="${#dates.format(usuario.ultimoAcesso, 'dd/MM/yyyy HH:mm')}"></span>
<td><span th:text="${usuario.acessos}"></span>
<td><span th:text="${usuario.ativo eq true} ? 'Ativo' : 'Inativo'"></span></td>
<td th:if="${usuario.login eq usuarioLogado.login || usuarioLogado.login eq 'admin' || usuarioLogado.login eq 'master'}"><a th:href="${(#mvc.url('UC#detalhesUsuario').arg(0, usuario.usuarioId)).build()}"><i class="small material-icons">perm_identity</i></a></td>
<td th:unless="${usuario.login eq usuarioLogado.login || usuarioLogado.login eq 'admin' || usuarioLogado.login eq 'master'}"><i class="small material-icons">lock_outline</i></td>
</tr>
</tbody>
</table>
<br>
<div class="container" align="center">
	<div th:if="${searchUsuario ne true && usuarios.totalPages != 1}">
		<ul class="pagination">
			<li th:class="${usuarios.number == 0} ? disabled"><a
				class="pageLink"
				th:href="@{/usuarios(pageSize=${selectedPageSize}, page=1)}">&laquo;</a>
			</li>
			<li th:class="${usuarios.number == 0} ? disabled"><a
				class="pageLink"
				th:href="@{/usuarios(pageSize=${selectedPageSize}, page=${usuarios.number})}">&larr;</a>
			</li>
			<li
				th:class="${usuarios.number == (page - 1)} ? 'active pointer-disabled'"
				th:each="page : ${#numbers.sequence(pager.startPage, pager.endPage)}">
				<a class="pageLink"
				th:href="@{/usuarios(pageSize=${selectedPageSize}, page=${page})}"
				th:text="${page}"></a>
			</li>
			<li
				th:class="${usuarios.number + 1 == usuarios.totalPages} ? disabled">
				<a class="pageLink"
				th:href="@{/usuarios(pageSize=${selectedPageSize}, page=${usuarios.number + 2})}">&rarr;</a>
			</li>
			<li
				th:class="${usuarios.number + 1 == usuarios.totalPages} ? disabled">
				<a class="pageLink"
				th:href="@{/usuarios(pageSize=${selectedPageSize}, page=${usuarios.totalPages})}">&raquo;</a>
			</li>
		</ul>
	</div>
</div>
<script>
	$(document).ready(function(){
		$('.dropdown-trigger').dropdown();
	});
	function buscarUsuarioAgora() {
		document.getElementById("formBuscarUsuario").submit();
	}
</script>
<script type="text/javascript" src="js/materialize.min.js"></script>
<script th:inline="javascript">
	/*<![CDATA[*/
	function changePageAndSize() {
		$('#pageSizeSelect').change(function(evt) {window.location.replace("/tattools/usuarios?pageSize=" + this.value + "&page=1");});}
	/*]]>*/
</script>
</body>
<div th:replace="fragments/footer :: footer">&nbsp;</div>
</html>